let survey="",response={},siteUsersData=[];function callBackSiteUsers(e){response=JSON.parse(e),fillSurveyTableUsers(),ready()}function ready(){let e=$("#site-survey-datatable").DataTable({pagingType:"simple",lengthChange:!1,info:!1,ordering:!1,filter:!0,data:siteUsersData,columns:[{title:""},{title:"Email"},{title:"Date"}],columnDefs:[{searchable:!1,orderable:!1,targets:0,width:30,className:"details-control",data:null,defaultContent:""}]});$("#site-survey-datatable tbody").on("click","td.details-control",(function(){var t=e.row($(this).parents("tr")).data();showUserChart(t[0],t[1])}))}function showUserChart(e,t){$.ajax({url:"https://cors-anywhere.herokuapp.com/https://api.ahmedalnajjar.com/dev/survey",type:"post",dataType:"json",data:JSON.stringify({email:t,date:e}),contentType:"application/json",processData:!1,success:function(e){drawChart(e.body.Items[0].survey)},error:function(e,t,a){console.log(e,t,a)}})}function fillSurveyTableUsers(){$.each(response.body.Items,(function(e,t){let a=new Date(t.created);siteUsersData.push([t.created,t.email,a.toString("YYYY-MM-dd")])}))}function httpGetAsync(e,t,a){var s=new XMLHttpRequest;s.onreadystatechange=function(){4==s.readyState&&200==s.status&&a(s.responseText)};var r="https://cors-anywhere.herokuapp.com/"+e;s.open(t,r,!0),s.send(null)}httpGetAsync("https://api.ahmedalnajjar.com/dev/survey","POST",callBackSiteUsers);