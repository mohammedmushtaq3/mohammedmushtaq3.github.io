sessionStorage.clear();let response="",path=testTool.parseURL(window.location.href);console.log(path);const link="https://api.ahmedalnajjar.com/dev/survey/";if(response=result,200==response.statusCode){var data=response.body,surveyContent="";surveyContent+='<div class="text-center py-3">';for(var i=data.sections.length;i>0;i--)surveyContent+='<span class="step"></span>';surveyContent+="</div>",data.sections.forEach(t=>{surveyContent+=`<div class="tab">\n                        <h2 class="text-center">${t.title.en}</h2>\n                        <h3 class="arabic-text text-center">${t.title.ar}</h3>`,"scale"===t.sectionType?(t.questions.forEach(t=>{surveyContent+=`<hr/><div class="form-group">\n                              <p>${t.en}</p>\n                              <p class="arabic-text text-right">${t.ar}</p>`,surveyContent+='<table class="w-100 text-center"><tr>',$.each(t.labels,(function(t,e){surveyContent+=`<th>\n                                <span class="label"> ${e.label.en}</span>\n                            </th>`})),surveyContent+="</tr><tr>",$.each(t.labels,(function(e,n){surveyContent+=`<td class="text-center">\n            <input type="radio" name="${t.en}" value="${n.label.value}">\n            </td>`})),surveyContent+="</tr></table>",surveyContent+="</div>"}),surveyContent+="</div>"):"boolean"===t.sectionType&&(t.questions.forEach(t=>{surveyContent+=`<hr/><div class="form-group">\n                              <p>${t.en}</p>\n                              <p class="arabic-text text-right">${t.ar}</p>\n                                    <table class="w-100 text-center">\n                                      <tr>\n                                            <th>TRUE</th>\n                                            <th>FALSE</th>\n                                        </tr>\n                                        <tr>\n                                            <td class="text-center"><input type="radio" name="${t.en}" value="true"></td>\n                                            <td class="text-center"><input type="radio" name="${t.en}" value="false"></td>\n                                        </tr>\n                                    </table>\n                          </div>`}),surveyContent+="</div>")}),$("#takeSurvey").click((function(){takeSurvey()}))}function takeSurvey(){$.showModal({title:'SURVEY <button class="btn btn-secondary float-right px-4" type="button" id="skipBtn" onclick="nextPrev(1)">Skip</button>',body:`<form id="surveyForm">${surveyContent}</form>`,footer:'<button class="btn btn-primary px-4" type="button" id="prevBtn" onclick="nextPrev(-1)">Previous</button>\n              <button class="btn btn-primary px-4" type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>',options:{backdrop:"static"}}),showTab(currentTab)}function onSurveySubmit(){var t=response.body;let e={},n=!1;e.name=t.name,e.description=t.description,e.created=t.created,e.updated=t.updated,e.sections=[],t.sections.forEach(t=>{let s={};s.title=t.title,s.questions=[],s.totalQuestions=0,s.sectionType=t.sectionType,t.questions.forEach(t=>{if(s.totalQuestions+=1,$(`input[name="${t.en}"]:checked`).val()){n=!0;let e={};e.en=t.en,e.ar=t.ar,e.value=$(`input[name="${t.en}"]:checked`).val(),s.questions.push(e)}}),n&&e.sections.push(s),n=!1});let s={};null!=sessionStorage.getItem("email")?s.email=sessionStorage.getItem("email"):null!=sessionStorage.getItem("uid")&&(s.uid=sessionStorage.getItem("uid")),s.survey=e,console.log("Submit FORM "+JSON.stringify(s)),$("#bootstrap-show-modal-0").modal("hide");$.ajax({url:"https://cors-anywhere.herokuapp.com/"+link,method:"PUT",contentType:"application/json",dataType:"json",data:JSON.stringify(s),processData:!1,success:function(t){$("#bootstrap-show-modal-0").hide(),$.showModal({body:"<h2>Thank You for Giving Survey</h2>"})},error:function(t,e,n){console.log(t,e,n)}})}function httpGetSync(t){var e,n=new XMLHttpRequest;return n.onreadystatechange=function(){4==this.readyState&&200==this.status&&(e=n.responseText)},n.open("GET","https://cors-anywhere.herokuapp.com/"+t,!1),n.send(),e}function copyToResponse(t){response=JSON.parse(t)}function httpGetAsync(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&200==n.status&&e(n.responseText)};var s="https://cors-anywhere.herokuapp.com/"+t;n.open("GET",s,!0),n.send(null)}null!=path.uid?(sessionStorage.setItem("uid",path.uid),takeSurvey()):($("#mail-modal").modal("show"),$("#form-mail").submit((function(t){t.preventDefault();let e=$('#form-mail input[type="email"]').val();sessionStorage.setItem("email",e),$("#mail-modal").modal("hide"),takeSurvey()})));